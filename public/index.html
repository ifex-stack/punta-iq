<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>PuntaIQ Predictions</title>
    <!-- This is a fallback index.html file for when the SPA main index.html can't be found -->
    <meta name="spa-fallback" content="true">
    <script type="text/javascript">
      // Configure PuntaIQ platform
      window.PuntaIQ = window.PuntaIQ || {};
      
      // Record initial load time to help with diagnostics
      window.PuntaIQ.initialLoadTime = Date.now();
      window.PuntaIQ.isFallbackPage = true;
      
      // Function to redirect to the correct application URL  
      function redirectToCorrectUrl() {
        // Redirect logic for Replit environments and localhost
        if (window.location.hostname.includes('.replit.dev') || 
            window.location.hostname === 'localhost' || 
            window.location.hostname.includes('replit.app')) {
            
          // Set the correct API endpoints and port
          window.PuntaIQ.apiBaseUrl = `${window.location.protocol}//${window.location.hostname}:3000`;
          window.PuntaIQ.aiServiceProxyUrl = `${window.location.protocol}//${window.location.hostname}:3000/ai-service`;
          
          // Extract the original path for recovery (could be in URL or stored in session)
          const urlParams = new URLSearchParams(window.location.search);
          const recoveryParam = urlParams.get('recovery');
          const recoveryFromParam = urlParams.get('from');
          
          // Check if we're in recovery mode
          if (recoveryParam === 'true') {
            console.log('PuntaIQ route recovery mode detected');
            
            // Find the target path either from URL param or session storage
            let targetPath = recoveryFromParam || 
                             sessionStorage.getItem('puntaiq_recovery_path') || 
                             '/';
            
            // Store the current intended path for later recovery if needed
            sessionStorage.setItem('puntaiq_intended_path', targetPath);
            
            console.log(`Will attempt to navigate to: ${targetPath} after app loads`);
          }
          
          // When we're on port 3000, set document.ready flag to help the app know it's ready
          if (window.location.port === '3000') {
            window.PuntaIQ.ready = true;
            console.log('PuntaIQ ready on correct port');
          } else {
            // Only redirect if not already on port 3000
            console.log('Redirecting to port 3000 for PuntaIQ application');
            
            // Preserve path and search params during redirect
            const currentPath = window.location.pathname || '/';
            const currentSearch = window.location.search || '';
            
            // Create the correct URL
            const redirectUrl = `${window.location.protocol}//${window.location.hostname}:3000${currentPath}${currentSearch}`;
            
            console.log(`Redirecting to: ${redirectUrl}`);
            window.location.replace(redirectUrl);
          }
        }
      }
      
      // Immediate execution
      try {
        redirectToCorrectUrl();
      } catch (e) {
        console.error('PuntaIQ initialization error:', e);
      }
    </script>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        margin: 0;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background: #f5f5f5;
      }
      
      .container {
        max-width: 480px;
        background: white;
        border-radius: 12px;
        padding: 32px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        text-align: center;
      }
      
      .logo {
        width: 80px;
        height: 80px;
        margin-bottom: 24px;
        position: relative;
      }
      
      .logo::before {
        content: "";
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: conic-gradient(#4f46e5, #3b82f6, #0ea5e9, #4f46e5);
        animation: rotate 4s linear infinite;
      }
      
      .logo::after {
        content: "PQ";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 72px;
        height: 72px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 24px;
        color: #4f46e5;
      }
      
      h1 {
        margin: 0 0 16px;
        color: #111827;
        font-size: 24px;
      }
      
      p {
        margin: 0 0 24px;
        color: #4b5563;
        line-height: 1.5;
      }
      
      .loader {
        display: inline-block;
        width: 30px;
        height: 30px;
        border: 3px solid rgba(79, 70, 229, 0.3);
        border-radius: 50%;
        border-top-color: #4f46e5;
        animation: spin 1s ease-in-out infinite;
        margin-bottom: 16px;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      
      @keyframes rotate {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="logo"></div>
      <div class="loader"></div>
      <h1>Loading PuntaIQ</h1>
      <p>Please wait while we prepare your sports predictions and analytics...</p>
    </div>
    <div id="root"></div>
  </body>
</html>